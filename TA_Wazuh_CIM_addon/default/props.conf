## Fields extraction
[wazuh]
SHOULD_LINEMERGE = false
KV_MODE = auto
REPORT-kv_for_wazuh_dvc = kv_for_dvc_host,kv_for_dvc_ip
REPORT-kv_for_wazuh = kv_for_default_wazuh,kv_for_splunk_wazuh,component_kv_for_splunk_wazuh,dest_kv_for_wazuh,file_kv_for_splunk_wazuh
REPORT-signature_for_wazuh = signature_id_for_default_wazuh,signature_id_for_splunk_wazuh
REPORT-object_kv_for_default_wazuh_550_552 = object_kv_for_default_wazuh_550_552
REPORT-object_kv_for_default_wazuh_553 = object_kv_for_default_wazuh_553
REPORT-object_kv_for_default_wazuh_554 = object_kv_for_default_wazuh_554
REPORT-object_kv_for_default_wazuh_580_581 = object_kv_for_default_wazuh_580_581
REPORT-object_kv_for_default_wazuh_591_592 = object_kv_for_default_wazuh_591_592
REPORT-object_kv_for_default_wazuh_594_596 = object_kv_for_default_wazuh_594_596
REPORT-object_kv_for_default_wazuh_598 = object_kv_for_default_wazuh_598
REPORT-object_kv_for_default_wazuh_5303_5304 = object_kv_for_default_wazuh_5303_5304
REPORT-object_kv_for_splunk_wazuh_550_596 = object_kv_for_splunk_wazuh_550_596
REPORT-object_kv_for_splunk_wazuh_554_598 = object_kv_for_splunk_wazuh_554_598

## Alias
FIELDALIAS-dvc_for_wazuh = dvc_host as dvc
FIELDALIAS-severity_id_for_wazuh = crit as severity_id
FIELDALIAS-signature_id_for_wazuh = id as signature_id
FIELDALIAS-signature_for_wazuh = description as signature
FIELDALIAS-subject_for_wazuh = description as subject
FIELDALIAS-src_for_wazuh = src_ip as src
FIELDALIAS-object_path_for_wazuh = file_path as object_path
FIELDALIAS-user_for_wazuh = acct as user
FIELDALIAS-md5_new_for_wazuh = md5_new as file_hash
FIELDALIAS-body_for_wazuh = message as body

## Change and Alert CIM Mapping
EVAL-object = COALESCE(file_name,host_name,orig_source)
EVAL-user = IF(isnotnull(target_user), target_user, user)
EVAL-src_user = IF(isnull(src_user), user, src_user)
EVAL-vendor = "Open Source Security"
EVAL-product = "HIDS"
EVAL-vendor_product = "wazuh:HIDS"
EVAL-app = CASE(match(signature_id, "5303|5304|5402"), "su", match(signature_id, "5503|5715|5716"), "ssh", match(signature_id, "18107|18149"), "win:local", match(signature_id, ".*"), "wazuh:HIDS")
EVAL-ids_type = "host"


## Lookup
LOOKUP-severity_for_wazuh = wazuh_severities_lookup severity_id OUTPUT severity
LOOKUP-action_for_wazuh = wazuh_action_lookup signature_id AS wazuh_signature_id OUTPUT action,status,change_type,change_type AS wazuh_change_type
LOOKUP-object_category_for_wazuh = wazuh_object_category_lookup signature_id OUTPUT object_category
